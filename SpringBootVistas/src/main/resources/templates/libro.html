<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>Libro</title>
	<!-- Latest compiled and minified CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

	<!-- Latest compiled JavaScript -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</head>

<body>
	<div class="container">
		<h2>Libro</h2>
		<!-- El th:each es como un bucle foreach, en este caso le estamos diciendo 
que recorra la variable autores y lo guarde en una variable llamada autor
	-->
		<div class="card w-50">
			<!-- Si yo estoy guardando cada elemento en una variable llamada 'autor'
		puedo acceder a sus propiedades y mostrarlas -->
			<div class="card-header"><span th:text="${libro.idlibro}"></span></div>
			<!--
			Cuando accedemos a la propiedad nombre spring boot busca el getter
			Es decir, intentará acceder a getNombre() -->
			<div class="card-body">
				<p th:text="${libro.titulo}"></p>
				<p th:text="${libro.genero.nombre}"></p>
			</div>
			<div class="card-footer"><span th:text="${libro.paginas}"></span></div>
		</div>
		<table class="table table-striped">
			<thead>
				<tr>
					<th>Id</th>
					<th>Nombre</th>
					<th>Accion</th>
				</tr>
			</thead>
			<tbody>
				<!-- Puedo acceder a la propiedad libros porque mi entidad autor
		tiene un getLibros() que me devuelve los libros y los recorro con el each -->
				<tr th:each="autor: ${libro.autores}">
					<td><span th:text="${autor.idautor}"></span></td>
					<td><span th:text="${autor.nombre}"></span></td>
					<td> <a class="btn btn-danger"
							th:href="@{/libro/delete/{id}/autor/{idautor} (id=${libro.idlibro},idautor=${autor.idautor})}">Borrar</a>
					</td>
				</tr>

			</tbody>
		</table>
		<form th:action="@{/libro/addautor}" method="POST">
			<input type="hidden" th:value="${libro.idlibro}" name="idlibro">

			<label for="genero">Añadir autor</label>
			<select class="form-control" name="idautor">
				<option th:each="g: ${autores}" th:value="${g.idautor}" th:text="${g.nombre}"></option>
			</select>
			<input class="btn btn-success" type="submit" value="Añadir">

		</form>
		<a class="btn btn-primary" th:href="@{/libro}">Ir al índice</a>
	</div>
</body>

</html>